# 1\_秒杀系统五个架构原则

秒杀系统本质上就是一个满足大并发、高性能和高可用的分布式系统。

> 架构原则：“4 要 1 不要”

## 1. **数据要尽量少**

### 1.1 用户请求的数据能少就少

请求的数据包括上传给系统的数据和系统的数据和系统返回给用户的数据（通常就是网页）。减少传输的数据量可以显著减少 CPU 的使用。 原因1： 网络传输耗时 原因2： 系统读写IO， 服务器在写网络时通常都要做压缩和字符编码

### 1.2 系统依赖的数据能少就少

数据一般是和后台服务以及数据库打交道的。调用其他服务会涉及数据的序列化和反序列化，而这也是 CPU 的一大杀手，同样也会也会增加延时。而且，数据库本身也容易成为一个瓶颈，所以和数据越简单、越小则越好。

## 2. 请求数要尽量少

        页面依赖的所有资源尽量少, 包括js, css, 图片, ajax请求. 其中ajax请求不同域名, 还涉及到DNS解析, 建立连接需要三次握手, 可能还存在串行加载的场景, 都增加耗时. 常用解决方案是合并css, js文件.

## 3. 路径要尽量短

        “路径”，就是用户发出请求到返回数据这个过程中，需求经过的中间的节点数。节点可以表示为一个系统或者一个新的 Socket 连接。每经过一个节点，一般都会产生一个新的 Socket 连接。而每增加一个连接都会增加新的不确定性。         缩短请求路径不仅可以增加可用性，同样可以有效提升性能（减少中中间节点可以减少数据的序列化与反序列化），并减少延时（可以减网络传输耗时）。         要缩短访问路径有一种办法，就是多个相互强依赖的应用合并部署在一起，把远程过程调用（RPC）变成 JVM 内部之间的方法调用。

## 4. 依赖要尽量少

        所谓依赖，指的是要完成一次用户请求必须依赖的系统或者服务，这里的依赖指的是强依赖。         举个例子，比如说你要展示秒杀页面，而这个页面必须强依赖商品信息、用户信息，还有其他如优惠券、成交列表等这些对秒杀不是非要不可的信息（弱依赖），这些弱依赖在紧急情况下就可以去掉。         要减少依赖，我们可以给系统进行分级。重要级别高的系统尽量少依赖地级别系统, 防止被拖垮。

## 5. 不要有单点

单点是大忌, 单点意味着没备份, 风险不可控. 必须消除单点. 避免单点的关键是服务状态与机器解绑, 即把服务无状态化, 可以随意在服务器中移动. 实现方式有很多, 例如动态配置等. 服务实现无状态化比较方便, 但存储服务就很难无状态化, 因为数据就存储在磁盘/内存上, 跟服务器绑定了. 这种情况就需要冗余多个备份.

## 场景架构

--&gt; [一些场景](https://time.geekbang.org/column/article/40726)

