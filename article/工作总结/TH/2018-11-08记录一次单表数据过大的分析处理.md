由于公司仅仅成立4年, 很多业务都是mysql单表存储, DBA对业务库进行表梳理, 发现了几个十亿级别的单表. 其中有一个是我负责的社群线的, 广告展示记录表

广告业务占用存储最大的表是ad_pull_log, 共***300多GB***, 记录数***27亿***.
```
CREATE TABLE `ad_pull_log` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `ad_id` bigint(20) NOT NULL,
  `type` int(11) DEFAULT NULL COMMENT '投放位置（类型）',
  `user_id` bigint(20) DEFAULT NULL,
  `attributes` varchar(800) NOT NULL DEFAULT '',
  `device_type` int(11) NOT NULL DEFAULT '0' COMMENT '设备类型。0-表示未知，1-andorid,2-IOS',
  `ip` varchar(30) DEFAULT NULL,
  `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=861292 DEFAULT CHARSET=utf8mb4 ROW_FORMAT=DYNAMIC;
```

经过分析, 得出以下一些结论
* 这表记录的事客户端拉取广告记录,  每拉一波广告就插入一次.  而客户端也有对广告做埋点给公司大数据组发送广告拉取与点击信息. 但区别是埋点发数据是去重的, 即广告被客户端第二次拉取, 是不会给大数据组发信息的, 也就意味着大数据组目前记录的信息是``用户拉取过广告``, 而``ad_pull_log``表记录的是``用户拉取了多少次广告``. 
* 这个表目前并没有实际作用, 纯粹是记录而已. 只是有潜在价值: 可以了解到广告投放次数以及投放目标信息, 未来有一定的商用价值, 因此不建议清除.
* 这个表是日志记录类的, 在广告业务流程中, 并没有实际用处, 不是必须的, 单表数据量太大也无法查询, 因此也没必要一直留着这么大量的数据在生产库占空间. 
* 这个表的数据, 只有经过统计分析后才能有价值, 因此考虑归属给大数据组处理. 

> 目前得出的暂时解决方案是: 
    1. 上策数据组商量是否应该交付给他们处理
    2. 下策是DBA提出的解决方案: 把数据导出来放到自己内部机房中存档保存, 交由DBA存储过程去把这个大表去分成多个小表. 线上只留3个月数据(虽说目前这个数据完全没有应用场景).

开会讨论后决定的方案: 
1. 客户端埋点逻辑完善一下
2. 日志表旧数据迁移存档, 交给数据组排期解析
3. 等步骤1,2都完成了后, 广告业务系统删除该表的插入逻辑



